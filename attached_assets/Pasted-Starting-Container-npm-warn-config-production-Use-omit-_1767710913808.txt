Starting Container
npm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64
`);lr.write(Kg.format.apply(Kg,e))}}Object.defineProperty(rt.exports,"isWin",{get:function(){return Li},set:function(t){Li=t}});rt.exports.warnTo=function(t){var e=lr;return lr=t,e};rt.exports.getFileName=function(t){var e=t||process.env,a=e.PGPASSFILE||(Li?Xg.join(e.APPDATA||"./","postgresql","pgpass.conf"):Xg.join(e.HOME||"./",".pgpass"));return a};rt.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Li?!0:(e=e||"<unkn>",a5(t.mode)?t.mode&(JE|YE)?(ap('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(ap('WARNING: password file "%s" is not a plain file',e),!1))};var r5=rt.exports.match=function(t,e){return Ya.slice(0,-1).reduce(function(a,n,r){return r==1&&Number(t[n]||KE)===Number(e[n])?a&&!0:a&&(e[n]==="*"||e[n]===t[n])},!0)};rt.exports.getPassword=function(t,e,a){var n,r=e.pipe(XE());function i(p){var c=i5(p);c&&s5(c)&&r5(t,c)&&(n=c[n5],r.end())}var s=function(){e.destroy(),a(n)},o=function(p){e.destroy(),ap("WARNING: error on reading file: %s",p),a(void 0)};e.on("error",o),r.on("data",i).on("end",s).on("error",o)};var i5=rt.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",a="",n=0,r=0,i=0,s={},o=!1,p=function(u,l,d){var m=t.substring(l,d);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(m=m.replace(/\\([:\\])/g,"$1")),s[Ya[u]]=m},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),a=t.charAt(c),o=n==tp-1,o){p(n,r);break}c>=0&&e==":"&&a!=="\\"&&(p(n,r,c+1),r=c+2,n+=1)}return s=Object.keys(s).length===tp?s:null,s},s5=rt.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},a=0;a<Ya.length;a+=1){var n=e[a],r=t[Ya[a]]||"",i=n(r);if(!i)return!1}return!0}});var ex=f((tA,np)=>{"use strict";var eA=require("path"),Yg=require("fs"),Fi=Jg();np.exports=function(t,e){var a=Fi.getFileName();Yg.stat(a,function(n,r){if(n||!Fi.usePgPass(r,a))return e(void 0);var i=Yg.createReadStream(a);Fi.getPassword(t,i,e)})};np.exports.warnTo=Fi.warnTo});var rx=f((aA,nx)=>{"use strict";var o5=require("events").EventEmitter,tx=Va(),rp=wg(),c5=Ii(),p5=Cc(),ax=Rg(),u5=pr(),l5=ep(),d5=kc(),zi=class extends o5{constructor(e){super(),this.connectionParameters=new p5(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let a=e||{};this._Promise=a.Promise||global.Promise,this._types=new c5(a.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!a.enableChannelBinding,this.connection=a.connection||new l5({stream:a.stream,ssl:this.connectionParameters.ssl,keepAlive:a.keepAlive||!1,keepAliveInitialDelayMillis:a.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=a.binary||u5.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=a.connectionTimeoutMillis||0}_errorAllQueries(e){let a=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(a(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(a),this.queryQueue.length=0}_connect(e){let a=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let r=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(r)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){a.ssl?n.requestSsl():n.startup(a.getStartupConf())}),n.on("sslconnect",function(){n.startup(a.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let r=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(r),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(r):this._handleErrorEvent(r):this._connectionError||this._handleErrorEvent(r)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((a,n)=>{this._connect(r=>{r?n(r):a()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let a=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){a.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{a.emit("error",n)});else if(this.password!==null)e();else try{ex()(this.connectionParameters,r=>{r!==void 0&&(this.connectionParameters.password=this.password=r),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let a=await d5.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(a)}catch(a){this.emit("error",a)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=rp.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(a){this.connection.emit("error",a)}})}async _handleAuthSASLContinue(e){try{await rp.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(a){this.connection.emit("error",a)}}_handleAuthSASLFinal(e){try{rp.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(a){this.connection.emit("error",a)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:a}=this;this.activeQuery=null,this.readyForQuery=!0,a&&a.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let a=this.activeQuery;if(!a){this._handleErrorEvent(e);return}this.activeQuery=null,a.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let a=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(a);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,a={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(a.application_name=n),e.replication&&(a.replication=""+e.replication),e.statement_timeout&&(a.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(a.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(a.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(a.options=e.options),a}cancel(e,a){if(e.activeQuery===a){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(a)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(a),1)}setTypeParser(e,a,n){return this._types.setTypeParser(e,a,n)}getTypeParser(e,a){return this._types.getTypeParser(e,a)}escapeIdentifier(e){return tx.escapeIdentifier(e)}escapeLiteral(e){return tx.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,a,n){let r,i,s,o,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,i=r=e,typeof a=="function"&&(r.callback=r.callback||a)):(s=e.query_timeout||this.connectionParameters.query_timeout,r=new ax(e,a,n),r.callback||(i=new this._Promise((c,u)=>{r.callback=(l,d)=>l?u(l):c(d)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(p=r.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{r.handleError(c,this.connection)}),p(c),r.callback=()=>{};let u=this.queryQueue.indexOf(r);u>-1&&this.queryQueue.splice(u,1),this._pulseQueryQueue()},s),r.callback=(c,u)=>{clearTimeout(o),p(c,u)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{r.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(r),this._pulseQueryQueue(),i):(process.nextTick(()=>{r.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(a=>{this.connection.once("end",a)})}};zi.Query=ax;nx.exports=zi});var cx=f((nA,ox)=>{"use strict";var f5=require("events").EventEmitter,ix=function(){},sx=(t,e)=>{let a=t.findIndex(e);return a===-1?void 0:t.splice(a,1)[0]},ip=class{constructor(e,a,n){this.client=e,this.idleListener=a,this.timeoutId=n}},en=class{constructor(e){this.callback=e}};function m5(){throw new Error("Release called on client which has already been released to the pool.")}function Ui(t,e){if(e)return{callback:e,result:void 0};let a,n,r=function(s,o){s?a(s):n(o)},i=new t(function(s,o){n=s,a=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:r,result:i}}function h5(t,e){return function a(n){n.client=e,e.removeListener("error",a),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var sp=class extends f5{constructor(e,a){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||a||op().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(a=>{this._remove(a.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let a=this._idle.pop();clearTimeout(a.timeoutId);let n=a.client;n.ref&&n.ref();let r=a.idleListener;return this._acquireClient(n,e,r,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,a){let n=sx(this._idle,i=>i.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(i=>i!==e);let r=this;e.end(()=>{r.emit("remove",e),typeof a=="function"&&a()})}connect(e){if(this.ending){let r=new Error("Cannot use a pool after calling end on the pool");return e?e(r):this.Promise.reject(r)}let a=Ui(this.Promise,e),n=a.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new en(a.callback)),n;let r=(o,p,c)=>{clearTimeout(s),a.callback(o,p,c)},i=new en(r),s=setTimeout(()=>{sx(this._pendingQueue,o=>o.callback===r),i.timedOut=!0,a.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(i),n}return this.newClient(new en(a.callback)),n}newClient(e){let a=new this.Client(this.options);this._clients.push(a);let n=h5(this,a);this.log("checking client timeout");let r,i=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,a.connection?a.connection.stream.destroy():a.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),a.connect(s=>{if(r&&clearTimeout(r),a.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==a),i&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,ix);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(a),this._idle.findIndex(c=>c.client===a)!==-1&&this._acquireClient(a,new en((c,u,l)=>l()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),a.once("end",()=>clearTimeout(o))}return this._acquireClient(a,e,n,!0)}})}_acquireClient(e,a,n,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),a.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),a.callback(i,void 0,ix);a.callback(void 0,e,e.release)}):a.callback(void 0,e,e.release)}_releaseOnce(e,a){let n=!1;return r=>{n&&m5(),n=!0,this._release(e,a,r)}}_release(e,a,n){if(e.on("error",a),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let i;this.options.idleTimeoutMillis&&this._isAboveMin()&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new ip(e,a,i)),this._pulseQueue()}query(e,a,n){if(typeof e=="function"){let i=Ui(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof a=="function"&&(n=a,a=void 0);let r=Ui(this.Promise,n);return n=r.callback,this.connect((i,s)=>{if(i)return n(i);let o=!1,p=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",p),this.log("dispatching query");try{s.query(e,a,(c,u)=>{if(this.log("query dispatched"),s.removeListener("error",p),!o)return o=!0,s.release(c),c?n(c):n(void 0,u)})}catch(c){return s.release(c),n(c)}}),r.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let a=Ui(this.Promise,e);return this._endCallback=a.callback,this._pulseQueue(),a.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,a)=>e+(this._expired.has(a)?1:0),0)}get totalCount(){return this._clients.length}};ox.exports=sp});var lx=f((rA,ux)=>{"use strict";var px=require("events").EventEmitter,v5=require("util"),cp=Va(),tn=ux.exports=function(t,e,a){px.call(this),t=cp.normalizeQueryConfig(t,e,a),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};v5.inherits(tn,px);var g5={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};tn.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let a in e){let n=g5[a]||a;t[n]=e[a]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};tn.prototype.then=function(t,e){return this._getPromise().then(t,e)};tn.prototype.catch=function(t){return this._getPromise().catch(t)};tn.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};tn.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let a=function(n,r,i){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(i.length>1?r.forEach((s,o)=>{s.forEach(p=>{e.emit("row",p,i[o])})}):r.forEach(function(s){e.emit("row",s,i)})),e.state="end",e.emit("end",i),e.callback&&e.callback(null,i)};if(process.domain&&(a=process.domain.bind(a)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(cp.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let r=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return a(r)}return t.native.execute(this.name,n,a)}return t.native.prepare(this.name,this.text,n.length,function(r){return r?a(r):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,a))})}else if(this.values){if(!Array.isArray(this.values)){let r=new Error("Query values must be an array");return a(r)}let n=this.values.map(cp.prepareValue);t.native.query(this.text,n,a)}else this.queryMode==="extended"?t.native.query(this.text,[],a):t.native.query(this.text,a)}});var vx=f((iA,hx)=>{"use strict";var dx;try{dx=require("pg-native")}catch(t){throw t}var x5=Ii(),fx=require("events").EventEmitter,y5=require("util"),b5=Cc(),mx=lx(),Ee=hx.exports=function(t){fx.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new x5(t.types),this.native=new dx({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new b5(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Ee.Query=mx;y5.inherits(Ee,fx);Ee.prototype._errorAllQueries=function(t){let e=a=>{process.nextTick(()=>{a.native=this.native,a.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Ee.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(a,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),a)return t(a);e.native.connect(n,function(r){if(r)return e.native.end(),t(r);e._connected=!0,e.native.on("error",function(i){e._queryable=!1,e._errorAllQueries(i),e.emit("error",i)}),e.native.on("notification",function(i){e.emit("notification",{channel:i.relname,payload:i.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};Ee.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,a)=>{this._connect(n=>{n?a(n):e()})})};Ee.prototype.query=function(t,e,a){let n,r,i,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")i=t.query_timeout||this.connectionParameters.query_timeout,r=n=t,typeof e=="function"&&(t.callback=e);else if(i=t.query_timeout||this.connectionParameters.query_timeout,n=new mx(t,e,a),!n.callback){let p,c;r=new this._Promise((u,l)=>{p=u,c=l}).catch(u=>{throw Error.captureStackTrace(u),u}),n.callback=(u,l)=>u?c(u):p(l)}return i&&(o=n.callback,s=setTimeout(()=>{let p=new Error("Query read timeout");process.nextTick(()=>{n.handleError(p,this.connection)}),o(p),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},i),n.callback=(p,c)=>{clearTimeout(s),o(p,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),r):(this._queryQueue.push(n),this._pulseQueryQueue(),r):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),r)};Ee.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let a;return t||(a=new this._Promise(function(n,r){t=i=>i?r(i):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),a};Ee.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Ee.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let a=this;e.once("_done",function(){a._pulseQueryQueue()})};Ee.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};Ee.prototype.ref=function(){};Ee.prototype.unref=function(){};Ee.prototype.setTypeParser=function(t,e,a){return this._types.setTypeParser(t,e,a)};Ee.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var pp=f((sA,gx)=>{"use strict";gx.exports=vx()});var op=f((cA,dr)=>{"use strict";var w5=rx(),_5=pr(),k5=ep(),S5=Ac(),E5=Va(),C5=cx(),T5=Ii(),{DatabaseError:A5}=Kc(),{escapeIdentifier:P5,escapeLiteral:q5}=Va(),O5=t=>class extends C5{constructor(a){super(a,t)}},up=function(t){this.defaults=_5,this.Client=t,this.Query=this.Client.Query,this.Pool=O5(this.Client),this._pools=[],this.Connection=k5,this.types=cr(),this.DatabaseError=A5,this.TypeOverrides=T5,this.escapeIdentifier=P5,this.escapeLiteral=q5,this.Result=S5,this.utils=E5};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?dr.exports=new up(pp()):(dr.exports=new up(w5),Object.defineProperty(dr.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new up(pp())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(dr.exports,"native",{value:t}),t}}))});var n3={};wp(n3,{log:()=>yp});module.exports=Gx(n3);var Wi=dn(oc(),1);var j=require("drizzle-orm");var Ix=require("drizzle-orm/node-postgres");var Ae=dn(op(),1),pA=Ae.default.Client,uA=Ae.default.Pool,lA=Ae.default.Connection,dA=Ae.default.types,fA=Ae.default.Query,mA=Ae.default.DatabaseError,hA=Ae.default.escapeIdentifier,vA=Ae.default.escapeLiteral,gA=Ae.default.Result,xA=Ae.default.TypeOverrides,yA=Ae.default.defaults,xx=Ae.default;var vp={};wp(vp,{BotStateEnum:()=>ZC,ExitReasonEnum:()=>KC,LogLevelEnum:()=>JC,SymbolEnum:()=>WC,TradeSideEnum:()=>XC,TradingModeEnum:()=>VC,botStates:()=>Pt,configs:()=>tt,controlActionSchema:()=>YC,healthChecks:()=>at,insertBotStateSchema:()=>FC,insertConfigSchema:()=>GC,insertHealthCheckSchema:()=>QC,insertLogEntrySchema:()=>HC,insertMarketEventSchema:()=>$C,insertMetricsSchema:()=>zC,insertTradeSchema:()=>UC,logEntries:()=>qt,marketEvents:()=>pt,metrics:()=>et,trades:()=>de});var x=require("drizzle-orm/pg-core"),At=require("drizzle-zod");var I;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{let i={};for(let s of r)i[s]=s;return i},t.getValidEnumValues=r=>{let i=t.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),s={};for(let o of i)s[o]=r[o];return t.objectValues(s)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let i=[];for(let s in r)Object.prototype.hasOwnProperty.call(r,s)&&i.push(s);return i},t.find=(r,i)=>{for(let s of r)if(i(s))return s},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,i=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(I||(I={}));var dp;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(dp||(dp={}));var w=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),st=t=>{switch(typeof t){case"undefined":return w.undefined;case"string":return w.string;case"number":return isNaN(t)?w.nan:w.number;case"boolean":return w.boolean;case"function":return w.function;case"bigint":return w.bigint;case"symbol":return w.symbol;case"object":return Array.isArray(t)?w.array:t===null?w.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?w.promise:typeof Map<"u"&&t instanceof Map?w.map:typeof Set<"u"&&t instanceof Set?w.set:typeof Date<"u"&&t instanceof Date?w.date:w.object;default:return w.unknown}},y=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),I5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),Pe=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){let a=e||function(i){return i.message},n={_errors:[]},r=i=>{for(let s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)n._errors.push(a(s));else{let o=n,p=0;for(;p<s.path.length;){let c=s.path[p];p===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(a(s))):o[c]=o[c]||{_errors:[]},o=o[c],p++}}};return r(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},n=[];for(let r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:a}}get formErrors(){return this.flatten()}};Pe.create=t=>new Pe(t);var rn=(t,e)=>{let a;switch(t.code){case y.invalid_type:t.received===w.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case y.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,I.jsonStringifyReplacer)}`;break;case y.unrecognized_keys:a=`Unrecognized key(s) in object: ${I.joinValues(t.keys,", ")}`;break;case y.invalid_union:a="Invalid input";break;case y.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${I.joinValues(t.options)}`;break;case y.invalid_enum_value:a=`Invalid enum value. Expected ${I.joinValues(t.options)}, received '${t.received}'`;break;case y.invalid_arguments:a="Invalid function arguments";break;case y.invalid_return_type:a="Invalid function return type";break;case y.invalid_date:a="Invalid date";break;case y.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:I.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case y.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case y.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case y.custom:a="Invalid input";break;case y.invalid_intersection_types:a="Intersection results could not be merged";break;case y.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case y.not_finite:a="Number must be finite";break;default:a=e.defaultError,I.assertNever(t)}return{message:a}},_x=rn;function j5(t){_x=t}function $i(){return _x}var Hi=t=>{let{data:e,path:a,errorMaps:n,issueData:r}=t,i=[...a,...r.path||[]],s={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let o="",p=n.filter(c=>!!c).slice().reverse();for(let c of p)o=c(s,{data:e,defaultError:o}).message;return{...r,path:i,message:o}},R5=[];function b(t,e){let a=$i(),n=Hi({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rn?void 0:rn].filter(r=>!!r)});t.common.issues.push(n)}var le=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let n=[];for(let r of a){if(r.status==="aborted")return E;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,a){let n=[];for(let r of a){let i=await r.key,s=await r.value;n.push({key:i,value:s})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,a){let n={};for(let r of a){let{key:i,value:s}=r;if(i.status==="aborted"||s.status==="aborted")return E;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||r.alwaysSet)&&(n[i.value]=s.value)}return{status:e.value,value:n}}},E=Object.freeze({status:"aborted"}),nn=t=>({status:"dirty",value:t}),ye=t=>({status:"valid",value:t}),fp=t=>t.status==="aborted",mp=t=>t.status==="dirty",Wt=t=>t.status==="valid",hr=t=>typeof Promise<"u"&&t instanceof Promise;function Gi(t,e,a,n){if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?n:a==="a"?n.call(t):n?n.value:e.get(t)}function kx(t,e,a,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(t,a):r?r.value=a:e.set(t,a),a}var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(k||(k={}));var fr,mr,De=class{constructor(e,a,n,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},yx=(t,e)=>{if(Wt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new Pe(t.common.issues);return this._error=a,this._error}}};function P(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:n,description:r}=t;if(e&&(a||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(s,o)=>{var p,c;let{message:u}=t;return s.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(p=u??n)!==null&&p!==void 0?p:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??a)!==null&&c!==void 0?c:o.defaultError}},description:r}}var q=class{get description(){return this._def.description}_getType(e){return st(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new le,ctx:{common:e.parent.common,data:e.data,parsedType:st(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(hr(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let n=this.safeParse(e,a);if(n.success)return n.data;throw n.error}safeParse(e,a){var n;let r={common:{issues:[],async:(n=a?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:a?.errorMap},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},i=this._parseSync({data:e,path:r.path,parent:r});return yx(r,i)}"~validate"(e){var a,n;let r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:r});return Wt(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((n=(a=i?.message)===null||a===void 0?void 0:a.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Wt(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,a){let n=await this.safeParseAsync(e,a);if(n.success)return n.data;throw n.error}async safeParseAsync(e,a){let n={common:{issues:[],contextualErrorMap:a?.errorMap,async:!0},path:a?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:st(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(hr(r)?r:Promise.resolve(r));return yx(n,i)}refine(e,a){let n=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,i)=>{let s=e(r),o=()=>i.addIssue({code:y.custom,...n(r)});return typeof Promise<"u"&&s instanceof Promise?s.then(p=>p?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,a){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof a=="function"?a(n,r):a),!1))}_refinement(e){return new qe({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Ne.create(this,this._def)}nullable(){return Ye.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ct.create(this)}promise(){return Tt.create(this,this._def)}or(e){return aa.create([this,e],this._def)}and(e){return na.create(this,e,this._def)}transform(e){return new qe({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new ca({...P(this._def),innerType:this,defaultValue:a,typeName:S.ZodDefault})}brand(){return new vr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new pa({...P(this._def),innerType:this,catchValue:a,typeName:S.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return gr.create(this,e)}readonly(){return ua.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},M5=/^c[^\s-]{8,}$/i,N5=/^[0-9a-z]+$/,D5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,B5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L5=/^[a-z0-9_-]{21}$/i,F5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,z5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,U5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",lp,H5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Q5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Z5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,V5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Sx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",X5=new RegExp(`^${Sx}$`);function Ex(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function K5(t){return new RegExp(`^${Ex(t)}$`)}function Cx(t){let e=`${Sx}T${Ex(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function J5(t,e){return!!((e==="v4"||!e)&&H5.test(t)||(e==="v6"||!e)&&Q5.test(t))}function Y5(t,e){if(!F5.test(t))return!1;try{let[a]=t.split("."),n=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function eC(t,e){return!!((e==="v4"||!e)&&G5.test(t)||(e==="v6"||!e)&&Z5.test(t))}var Et=class t extends q{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==w.string){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.string,received:i.parsedType}),E}let n=new le,r;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(r=this._getOrReturnCtx(e,r),s?b(r,{code:y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&b(r,{code:y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")U5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")lp||(lp=new RegExp($5,"u")),lp.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")B5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")L5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")M5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")N5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")D5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Cx(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?X5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?K5(i).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:y.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?z5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?J5(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Y5(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?eC(e.data,i.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?V5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:y.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?W5.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:y.invalid_string,message:i.message}),n.dirty()):I.assertNever(i);return{status:n.value,value:e.data}}_regex(e,a,n){return this.refinement(r=>e.test(r),{validation:a,code:y.invalid_string,...k.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var a,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(a=e?.offset)!==null&&a!==void 0?a:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...k.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...k.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...k.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a?.position,...k.errToObj(a?.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...k.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...k.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...k.errToObj(a)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Et.create=t=>{var e;return new Et({checks:[],typeName:S.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};function tC(t,e){let a=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=a>n?a:n,i=parseInt(t.toFixed(r).replace(".","")),s=parseInt(e.toFixed(r).replace(".",""));return i%s/Math.pow(10,r)}var Xt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==w.number){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.number,received:i.parsedType}),E}let n,r=new le;for(let i of this._def.checks)i.kind==="int"?I.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?tC(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_finite,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&I.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(a===null||n.value>a)&&(a=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Xt.create=t=>new Xt({checks:[],typeName:S.ZodNumber,coerce:t?.coerce||!1,...P(t)});var Kt=class t extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==w.bigint)return this._getInvalidInput(e);let n,r=new le;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:y.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):I.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.bigint,received:a.parsedType}),E}gte(e,a){return this.setLimit("min",e,!0,k.toString(a))}gt(e,a){return this.setLimit("min",e,!1,k.toString(a))}lte(e,a){return this.setLimit("max",e,!0,k.toString(a))}lt(e,a){return this.setLimit("max",e,!1,k.toString(a))}setLimit(e,a,n,r){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Kt.create=t=>{var e;return new Kt({checks:[],typeName:S.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...P(t)})};var Jt=class extends q{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==w.boolean){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.boolean,received:n.parsedType}),E}return ye(e.data)}};Jt.create=t=>new Jt({typeName:S.ZodBoolean,coerce:t?.coerce||!1,...P(t)});var Yt=class t extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==w.date){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_type,expected:w.date,received:i.parsedType}),E}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return b(i,{code:y.invalid_date}),E}let n=new le,r;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):I.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Yt.create=t=>new Yt({checks:[],coerce:t?.coerce||!1,typeName:S.ZodDate,...P(t)});var sn=class extends q{_parse(e){if(this._getType(e)!==w.symbol){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.symbol,received:n.parsedType}),E}return ye(e.data)}};sn.create=t=>new sn({typeName:S.ZodSymbol,...P(t)});var ea=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.undefined,received:n.parsedType}),E}return ye(e.data)}};ea.create=t=>new ea({typeName:S.ZodUndefined,...P(t)});var ta=class extends q{_parse(e){if(this._getType(e)!==w.null){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.null,received:n.parsedType}),E}return ye(e.data)}};ta.create=t=>new ta({typeName:S.ZodNull,...P(t)});var Ct=class extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return ye(e.data)}};Ct.create=t=>new Ct({typeName:S.ZodAny,...P(t)});var ot=class extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ye(e.data)}};ot.create=t=>new ot({typeName:S.ZodUnknown,...P(t)});var Ue=class extends q{_parse(e){let a=this._getOrReturnCtx(e);return b(a,{code:y.invalid_type,expected:w.never,received:a.parsedType}),E}};Ue.create=t=>new Ue({typeName:S.ZodNever,...P(t)});var on=class extends q{_parse(e){if(this._getType(e)!==w.undefined){let n=this._getOrReturnCtx(e);return b(n,{code:y.invalid_type,expected:w.void,received:n.parsedType}),E}return ye(e.data)}};on.create=t=>new on({typeName:S.ZodVoid,...P(t)});var ct=class t extends q{_parse(e){let{ctx:a,status:n}=this._processInputParams(e),r=this._def;if(a.parsedType!==w.array)return b(a,{code:y.invalid_type,expected:w.array,received:a.parsedType}),E;if(r.exactLength!==null){let s=a.data.length>r.exactLength.value,o=a.data.length<r.exactLength.value;(s||o)&&(b(a,{code:s?y.too_big:y.too_small,minimum:o?r.exactLength.value:void 0,maximum:s?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(b(a,{code:y.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(b(a,{code:y.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),a.common.async)return Promise.all([...a.data].map((s,o)=>r.type._parseAsync(new De(a,s,a.path,o)))).then(s=>le.mergeArray(n,s));let i=[...a.data].map((s,o)=>r.type._parseSync(new De(a,s,a.path,o)));return le.mergeArray(n,i)}get element(){return this._def.type}min(e,a){return new t({...this._def,minLength:{value:e,message:k.toString(a)}})}max(e,a){return new t({...this._def,maxLength:{value:e,message:k.toString(a)}})}length(e,a){return new t({...this._def,exactLength:{value:e,message:k.toString(a)}})}nonempty(e){return this.min(1,e)}};ct.create=(t,e)=>new ct({type:t,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function an(t){if(t instanceof Ce){let e={};for(let a in t.shape){let n=t.shape[a];e[a]=Ne.create(an(n))}return new Ce({...t._def,shape:()=>e})}else return t instanceof ct?new ct({...t._def,type:an(t.element)}):t instanceof Ne?Ne.create(an(t.unwrap())):t instanceof Ye?Ye.create(an(t.unwrap())):t instanceof Je?Je.create(t.items.map(e=>an(e))):t}var Ce=class t extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=I.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==w.object){let c=this._getOrReturnCtx(e);return b(c,{code:y.invalid_type,expected:w.object,received:c.parsedType}),E}let{status:n,ctx:r}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ue&&this._def.unknownKeys==="strip"))for(let c in r.data)s.includes(c)||o.push(c);let p=[];for(let c of s){let u=i[c],l=r.data[c];p.push({key:{status:"valid",value:c},value:u._parse(new De(r,l,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof Ue){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of o)p.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")o.length>0&&(b(r,{code:y.unrecogniznpm warn config production Use `--omit=dev` instead.
> rest-express@1.0.0 start
> NODE_ENV=production node dist/index.cjs
/app/dist/index.cjs:64